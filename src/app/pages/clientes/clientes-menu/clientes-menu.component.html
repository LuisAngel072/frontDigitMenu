<div class="container">
  <header class="header">
    <input type="text" class="search-bar" placeholder="Buscar platillo...">
    <button class="material-symbols-outlined">
      shopping_cart
    </button>
  </header>

  <div class="accordion" id="menuAccordion">
    <div *ngFor="let cat of categorias; let i = index" class="accordion-item">
      <h2 class="accordion-header" [id]="'heading' + i">
        <button class="accordion-button custom-button" type="button" data-bs-toggle="collapse"
          [attr.data-bs-target]="'#collapse' + i" aria-expanded="false"
          [attr.aria-controls]="'collapse' + i">
          <img [src]="baseUrl + cat.ruta_img" alt="{{ cat.nombre_cat }}" class="img-cat">
          {{ cat.nombre_cat }}
        </button>
      </h2>

      <div [id]="'collapse' + i" class="accordion-collapse collapse"
        [attr.aria-labelledby]="'heading' + i" data-bs-parent="#menuAccordion">
        <div class="accordion-body">
          <div class="list-group">
            <div *ngFor="let sub of cat.subcategorias">
              <button class="list-group-item list-group-item-action" data-bs-toggle="collapse"
                [attr.data-bs-target]="'#subcat-' + sub.id_subcat">
                <img [src]="baseUrl + sub.ruta_img" alt="{{ sub.nombre_subcat }}" class="img-subcat">
                {{ sub.nombre_subcat }}
              </button>

              <div class="collapse" [id]="'subcat-' + sub.id_subcat">
                <div *ngIf="sub.productos?.length > 0">
                  <div *ngFor="let prod of sub.productos" class="list-group-item list-group-item-action prod-item"
                    (click)="showProduct(prod)">
                    <img [src]="baseUrl + prod.img_prod" alt="{{ prod.nombre_prod }}" class="img-prod">
                    <div>
                      <strong>{{ prod.nombre_prod }}</strong> - ${{ prod.precio }}
                      <p class="text-muted small">{{ prod.descripcion }}</p>
                    </div>
                  </div>
                </div>
                <div *ngIf="!sub.productos || sub.productos.length === 0">
                  <p class="text-muted ms-3">Sin productos</p>
                </div>
              </div>
            </div>

            <div *ngIf="cat.subcategorias.length === 0">
              <p class="text-muted">No hay subcategorías</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- PRODUCT MODAL -->
<div class="modal fade" id="productModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ selectedProduct?.nombre_prod }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body p-3">
        <img [src]="baseUrl + selectedProduct?.img_prod" class="img-fluid rounded mb-3" alt="Producto">
        <p>{{ selectedProduct?.descripcion }}</p>

        <div class="mb-3">
          <h6>Tamaño:</h6>
          <div *ngFor="let opc of opciones">
            <input type="radio" name="tamano" [value]="opc" [(ngModel)]="selectedOpcion" (change)="calcularPrecio()">
            {{ opc.opcion_id.nombre_opcion }} (+$ {{ opc.precio }})
          </div>
        </div>

        <div class="mb-3">
          <h6>Extras:</h6>
          <div *ngFor="let ext of extras">
            <input type="checkbox" [value]="ext" (change)="toggleExtra(ext)">
            {{ ext.extra_id.nombre_extra }} (+$ {{ ext.precio }})
          </div>
        </div>

        <h5 class="mt-4">Precio total: ${{ precioTotal }}</h5>
        <button class="btn btn-warning w-100 mt-2" (click)="agregarACuenta()">Agregar a la cuenta</button>
      </div>
    </div>
  </div>
</div>

</div>
